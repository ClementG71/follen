---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import { getBlogPost } from '../../../utils/api';
import { marked } from 'marked';

// Récupérer l'article spécifique
const slug = Astro.params.slug;
const post = await getBlogPost(slug);

// Convertir le contenu Markdown en HTML
const contentHtml = post ? marked(post.body) : '';
---

<BaseLayout title={post?.title || 'Article Follen non trouvé'}>
    <section>
        {post ? (
            <article class="max-w-4xl mx-auto">
                {post.header_image_url && (
                    <img src={post.header_image_url} alt={post.title} class="w-full h-64 object-cover rounded-lg mb-6">
                )}
                
                <h1 class="text-4xl font-bold mb-4">Follen - {post.title}</h1>
                
                <div class="flex flex-wrap gap-4 text-gray-600 text-sm mb-6">
                    <span>Par {post.author}</span>
                    <span>•</span>
                    <span>{new Date(post.date).toLocaleDateString('fr-FR')}</span>
                </div>
                
                <div class="flex flex-wrap gap-2 mb-6">
                    {post.categories.map((category, index) => (
                        <span key={index} class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">
                            {category}
                        </span>
                    ))}
                </div>
                
                <div class="prose max-w-none mb-8">
                    <set:html>{contentHtml}</set:html>
                </div>
                
                <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                    <a href="/articles" class="text-blue-600 hover:underline">← Retour aux articles Follen</a>
                </div>
            </article>
        ) : (
            <div class="text-center py-12">
                <h1 class="text-3xl font-bold mb-4">Article Follen non trouvé</h1>
                <p class="text-gray-600">L'article Follen que vous recherchez n'existe pas.</p>
                <a href="/articles" class="text-blue-600 hover:underline mt-4 inline-block">← Retour aux articles Follen</a>
            </div>
        )}
    </section>
</BaseLayout>